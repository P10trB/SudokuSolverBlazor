@page "/"
@using SudokuSolver.Services
@rendermode InteractiveServer

<div class="main-container">
    <h3>Sudoku Solver</h3>

    <!-- Plansza Sudoku -->
    <div class="sudoku-board">
        @for (int row = 0; row < 9; row++)
        {
            @for (int col = 0; col < 9; col++)
            {
                int r = row;
                int c = col;

                <input type="number" 
                       class="@GetCellClass(r, c)" 
                       min="1" max="9" 
                       @bind="Board[r, c]" />
            }
        }
    </div>

    <!-- Przyciski -->
    <div class="controls">
        <button class="solve-btn" @onclick="SolveSudoku">Solve sudoku</button>
        <button class="clear-btn" @onclick="ClearBoard">Clear</button>
    </div>
    
    <!-- Komunikat -->
    @if (!string.IsNullOrEmpty(Message))
    {
        <p class="status-msg">@Message</p>
    }
</div>

@code {
    // Tablica danych
    private int?[,] Board = new int?[9, 9];
    private string Message = "";
    
    // Instancja serwisu z logiką
    private SudokuService _solver = new SudokuService();

    private void SolveSudoku()
    {
        bool success = _solver.SolveSudoku(Board);

        if (success)
        {
            Message = "Rozwiązano pomyślnie!";
        }
        else
        {
            Message = "Nie znaleziono rozwiązania.";
        }
    }

    private void ClearBoard()
    {
        Board = new int?[9, 9];
        Message = "";
    }
    
    private string GetCellClass(int row, int col)
    {
        // "cell" to podstawowa klasa z CSS
        var classes = new List<string> { "cell" };
        
        // Dodaj grubą linię z prawej co 3 kolumny (ale nie na samym końcu)
        if ((col + 1) % 3 == 0 && col < 8) classes.Add("border-right-thick");
        
        // Dodaj grubą linię na dole co 3 wiersze (ale nie na samym dole)
        if ((row + 1) % 3 == 0 && row < 8) classes.Add("border-bottom-thick");
        
        // Złącz nazwy klas spacją, np. "cell border-right-thick"
        return string.Join(" ", classes);
    }
}